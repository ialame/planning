# ========== POKEMON CARD ORDER PLANNING SYSTEM ==========
# Configuration compatible avec table 'order' partagee (READ-ONLY)

# Application
spring.application.name=pokemon-card-planning
server.port=8080

# Database Configuration - MariaDB with shared table compatibility
spring.datasource.url=jdbc:mariadb://localhost:3306/dev?useSSL=false&allowPublicKeyRetrieval=true&createDatabaseIfNotExist=true&useServerPrepStmts=true&cachePrepStmts=true
spring.datasource.username=ia
spring.datasource.password=foufafou
spring.datasource.driver-class-name=org.mariadb.jdbc.Driver

# Connection Pool
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# JPA/Hibernate Configuration - SAFE MODE for shared tables
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MariaDBDialect
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# CRITICAL: Read-only mode for shared tables
spring.jpa.properties.hibernate.globally_quoted_identifiers=false
spring.jpa.properties.hibernate.hbm2ddl.auto=none
spring.jpa.defer-datasource-initialization=false

# Liquibase Configuration - SAFE migrations only
spring.liquibase.enabled=true
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.yml
spring.liquibase.contexts=development
spring.liquibase.drop-first=false
spring.liquibase.default-schema=dev

# CORS Configuration
spring.web.cors.allowed-origins=http://localhost:3000,http://localhost:5173,http://127.0.0.1:3000
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=false

# Logging Configuration
logging.level.root=INFO
logging.level.com.pcagrade=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.springframework.transaction=INFO
logging.level.liquibase=INFO

# Error handling
server.error.include-stacktrace=on-param
server.error.include-message=always

# ========== POKEMON CARD PLANNING CONFIGURATION ==========

# Pokemon Card Processing Configuration
planning.card.processing.time=3

# NEW: Scanning time per order (regardless of card count)
planning.order.scanning.time=5

# Employee break time (deprecated - use planning.task.break.minutes)
planning.employee.break.time=15

# NEW: Configurable break time - default 5 minutes
planning.task.break.minutes=5

# Working hours
planning.workday.start=09:00
planning.workday.end=17:00

# Management endpoints
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always

# ========== SHARED TABLE CONFIGURATION ==========
# Configuration specifique pour la table 'order' partagee

# Order table compatibility settings
order.table.readonly=true
order.status.integer.mapping=true
order.adapter.service.enabled=true

# Avertissements pour les operations dangereuses
order.table.modification.warning=true

# ========== NOTES IMPORTANTES ==========
# 1. La table 'order' est en lecture seule - utilisez OrderAdapterService
# 2. Les status sont stockes en INTEGER (0=PENDING, 1=SCHEDULED, etc.)
# 3. Seules les tables j_planning et j_employee peuvent etre modifiees
# 4. Les vues v_order_with_status_enum fournissent l'interface ENUM
# 5. OrderAdapterService encapsule toute la logique metier